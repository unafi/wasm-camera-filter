<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ€§èƒ½æ¯”è¼ƒã¨æœ€é©åŒ– - WebAssembly ã‚«ãƒ¡ãƒ©ãƒ•ã‚£ãƒ«ã‚¿</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #7f8c8d;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.5;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }
        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .performance-table th,
        .performance-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        .performance-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .wasm-better {
            background-color: #d4edda;
            color: #155724;
        }
        .js-better {
            background-color: #f8d7da;
            color: #721c24;
        }
        .benchmark-chart {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            overflow-x: auto;
        }
        .benchmark-chart pre {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            white-space: pre;
            margin: 0;
            text-align: left;
            display: inline-block;
        }
        .optimization-tip {
            background: #e7f3ff;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š æ€§èƒ½æ¯”è¼ƒã¨æœ€é©åŒ–</h1>
        
        <p><a href="index.html">â† æŠ€è¡“è§£èª¬ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a></p>

        <div class="highlight">
            <strong>ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯</strong>ã€WebAssemblyã¨JavaScriptã®æ€§èƒ½æ¯”è¼ƒçµæœã¨ã€æœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚
        </div>

        <section>
            <h2>âš¡ æ€§èƒ½æ¯”è¼ƒçµæœ</h2>
            
            <h3>ãƒ†ã‚¹ãƒˆç’°å¢ƒ</h3>
            <ul>
                <li><strong>ãƒ‡ãƒã‚¤ã‚¹</strong>: iPhone 11, Windows PC (Chrome)</li>
                <li><strong>ç”»åƒã‚µã‚¤ã‚º</strong>: 640x480 (307,200ãƒ”ã‚¯ã‚»ãƒ«)</li>
                <li><strong>æ¸¬å®šæ–¹æ³•</strong>: requestAnimationFrame ã«ã‚ˆã‚‹ FPS æ¸¬å®š</li>
                <li><strong>æ¸¬å®šæ™‚é–“</strong>: å„ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ30ç§’é–“ã®å¹³å‡å€¤</li>
            </ul>

            <table class="performance-table">
                <thead>
                    <tr>
                        <th>ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ</th>
                        <th>WebAssembly (FPS)</th>
                        <th>JavaScript (FPS)</th>
                        <th>é€Ÿåº¦æ¯”</th>
                        <th>å„ªä½æ€§</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>HDRã‚¢ãƒ‹ãƒ¡èª¿</td>
                        <td class="wasm-better">45-55</td>
                        <td>40-50</td>
                        <td>1.1x</td>
                        <td class="wasm-better">WASM</td>
                    </tr>
                    <tr>
                        <td>ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ–ãƒ©ãƒ¼</td>
                        <td class="wasm-better">50-60</td>
                        <td>15-25</td>
                        <td>2.5x</td>
                        <td class="wasm-better">WASM</td>
                    </tr>
                    <tr>
                        <td>ã‚¨ãƒƒã‚¸æ¤œå‡º</td>
                        <td class="wasm-better">55-60</td>
                        <td>35-45</td>
                        <td>1.4x</td>
                        <td class="wasm-better">WASM</td>
                    </tr>
                    <tr>
                        <td>ã‚»ãƒ”ã‚¢èª¿</td>
                        <td>58-60</td>
                        <td class="js-better">55-60</td>
                        <td>1.0x</td>
                        <td>åŒç­‰</td>
                    </tr>
                    <tr>
                        <td>ãƒã‚¬ãƒ•ã‚£ãƒ«ãƒ </td>
                        <td>58-60</td>
                        <td class="js-better">57-60</td>
                        <td>1.0x</td>
                        <td>åŒç­‰</td>
                    </tr>
                    <tr>
                        <td>ã‚·ãƒ£ãƒ¼ãƒ—ãƒã‚¹</td>
                        <td class="wasm-better">52-58</td>
                        <td>30-40</td>
                        <td>1.6x</td>
                        <td class="wasm-better">WASM</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section>
            <h2>ğŸ” æ€§èƒ½å·®ã®è¦å› åˆ†æ</h2>
            
            <h3>1. è¨ˆç®—é›†ç´„çš„ãªå‡¦ç†ã§ã®WebAssemblyå„ªä½æ€§</h3>
            <div class="optimization-tip">
                <strong>ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ–ãƒ©ãƒ¼ (2.5å€é«˜é€Ÿ)</strong><br>
                è¿‘å‚ãƒ”ã‚¯ã‚»ãƒ«ã®å¤§é‡è¨ˆç®—ãŒå¿…è¦ãªå‡¦ç†ã§ã¯ã€WebAssemblyã®ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰å®Ÿè¡ŒãŒå¤§ããªå„ªä½æ€§ã‚’ç™ºæ®
            </div>
            
            <div class="code-block">
// ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ–ãƒ©ãƒ¼ã®è¨ˆç®—é‡
ç”»åƒã‚µã‚¤ã‚º: 640 Ã— 480 = 307,200 ãƒ”ã‚¯ã‚»ãƒ«
ã‚«ãƒ¼ãƒãƒ«ã‚µã‚¤ã‚º: 7 Ã— 7 = 49 è¿‘å‚ãƒ”ã‚¯ã‚»ãƒ«
ç·è¨ˆç®—å›æ•°: 307,200 Ã— 49 Ã— 2ãƒ‘ã‚¹ = ç´„3,000ä¸‡å›ã®è¨ˆç®—

WebAssembly: ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚³ãƒ¼ãƒ‰ã§é«˜é€Ÿå®Ÿè¡Œ
JavaScript: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ãƒ¼å®Ÿè¡Œã§ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
            </div>

            <h3>2. å˜ç´”ãªå‡¦ç†ã§ã®JavaScriptå¥é—˜</h3>
            <div class="optimization-tip">
                <strong>ã‚»ãƒ”ã‚¢èª¿ãƒ»ãƒã‚¬ãƒ•ã‚£ãƒ«ãƒ  (åŒç­‰æ€§èƒ½)</strong><br>
                å˜ç´”ãªãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã®è¨ˆç®—ã§ã¯ã€ç¾ä»£ã®JavaScriptã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆV8ï¼‰ã®æœ€é©åŒ–ãŒåŠ¹æœçš„
            </div>
            
            <div class="code-block">
// ã‚»ãƒ”ã‚¢èª¿ã®è¨ˆç®—é‡ï¼ˆãƒ”ã‚¯ã‚»ãƒ«ã‚ãŸã‚Šï¼‰
for (let i = 0; i < data.length; i += 4) {
    // 3å›ã®ä¹—ç®— + 3å›ã®åŠ ç®—ã®ã¿
    data[i] = r * 0.393 + g * 0.769 + b * 0.189;     // 1å›
    data[i + 1] = r * 0.349 + g * 0.686 + b * 0.168; // 2å›
    data[i + 2] = r * 0.272 + g * 0.534 + b * 0.131; // 3å›
}

â†’ V8ã‚¨ãƒ³ã‚¸ãƒ³ã®JITæœ€é©åŒ–ãŒåŠ¹æœçš„ã«åƒã
            </div>
        </section>

        <section>
            <h2>ğŸš€ WebAssemblyæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ</h2>
            
            <h3>1. ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ€é©åŒ–</h3>
            <div class="code-block">
// åŠ¹ç‡çš„ãªãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹ï¼ˆRustï¼‰
#[inline(always)]
fn process_pixel_row(data: &mut [u8], y: usize, width: usize) {
    let row_start = y * width * 4;
    let row_end = row_start + width * 4;
    
    // è¡Œå˜ä½ã§ã®é€£ç¶šã‚¢ã‚¯ã‚»ã‚¹ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡å‘ä¸Šï¼‰
    for i in (row_start..row_end).step_by(4) {
        // ãƒ”ã‚¯ã‚»ãƒ«å‡¦ç†...
    }
}
            </div>
            
            <h3>2. é–¢æ•°ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–</h3>
            <div class="code-block">
// ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–ã«ã‚ˆã‚‹é–¢æ•°å‘¼ã³å‡ºã—ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸›
#[inline(always)]
fn clamp_u8(value: f32) -> u8 {
    value.max(0.0).min(255.0) as u8
}

// ä½¿ç”¨ä¾‹
data[i] = clamp_u8(processed_r * 255.0);
            </div>
            
            <h3>3. ãƒ«ãƒ¼ãƒ—ã‚¢ãƒ³ãƒ­ãƒ¼ãƒªãƒ³ã‚°</h3>
            <div class="code-block">
// 4ãƒ”ã‚¯ã‚»ãƒ«åŒæ™‚å‡¦ç†ã«ã‚ˆã‚‹ãƒ«ãƒ¼ãƒ—ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸›
for chunk in data.chunks_exact_mut(16) { // 4ãƒ”ã‚¯ã‚»ãƒ« = 16ãƒã‚¤ãƒˆ
    // 4ã¤ã®ãƒ”ã‚¯ã‚»ãƒ«ã‚’åŒæ™‚å‡¦ç†
    process_4_pixels(chunk);
}
            </div>
        </section>

        <section>
            <h2>ğŸ“ˆ JavaScriptæœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ</h2>
            
            <h3>1. å‹ã®ä¸€è²«æ€§</h3>
            <div class="code-block">
// V8ã‚¨ãƒ³ã‚¸ãƒ³ã®æœ€é©åŒ–ã‚’ä¿ƒé€²
function processPixel(r, g, b) {
    // å¸¸ã«åŒã˜å‹ï¼ˆNumberï¼‰ã‚’ä½¿ç”¨
    const sepia_r = r * 0.393 + g * 0.769 + b * 0.189;
    const sepia_g = r * 0.349 + g * 0.686 + b * 0.168;
    const sepia_b = r * 0.272 + g * 0.534 + b * 0.131;
    
    return [sepia_r | 0, sepia_g | 0, sepia_b | 0]; // æ•´æ•°å¤‰æ›
}
            </div>
            
            <h3>2. é…åˆ—ã‚¢ã‚¯ã‚»ã‚¹ã®æœ€é©åŒ–</h3>
            <div class="code-block">
// åŠ¹ç‡çš„ãªé…åˆ—ã‚¢ã‚¯ã‚»ã‚¹
const length = data.length;
for (let i = 0; i < length; i += 4) {
    // ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨ˆç®—ã‚’æœ€å°åŒ–
    const r = data[i];
    const g = data[i + 1];
    const b = data[i + 2];
    // å‡¦ç†...
}
            </div>
        </section>

        <section>
            <h2>ğŸ¯ å®Ÿç”¨çš„ãªé¸æŠæŒ‡é‡</h2>
            
            <div class="benchmark-chart">
                <h3>å‡¦ç†ã®è¤‡é›‘ã• vs æ€§èƒ½å‘ä¸Š</h3>
                <pre>
æ€§èƒ½å‘ä¸Šç‡
    â†‘
3.0xâ”‚    â—ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ–ãƒ©ãƒ¼
    â”‚
2.5xâ”‚
    â”‚
2.0xâ”‚
    â”‚         â—ã‚·ãƒ£ãƒ¼ãƒ—ãƒã‚¹
1.5xâ”‚    
    â”‚              â—ã‚¨ãƒƒã‚¸æ¤œå‡º
1.0xâ”‚                   â—HDRã‚¢ãƒ‹ãƒ¡èª¿
    â”‚                        â—â—ã‚»ãƒ”ã‚¢ãƒ»ãƒã‚¬
0.5xâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
    å˜ç´”    ä¸­ç¨‹åº¦    è¤‡é›‘    éå¸¸ã«è¤‡é›‘   å‡¦ç†ã®è¤‡é›‘ã•
                </pre>
            </div>
            
            <div class="optimization-tip">
                <strong>WebAssemblyã‚’é¸ã¶ã¹ãå ´é¢:</strong>
                <ul>
                    <li>è¿‘å‚ãƒ”ã‚¯ã‚»ãƒ«å‚ç…§ãŒå¤šã„å‡¦ç†ï¼ˆãƒ–ãƒ©ãƒ¼ã€ã‚·ãƒ£ãƒ¼ãƒ—ãƒã‚¹ï¼‰</li>
                    <li>è¤‡é›‘ãªæ•°å­¦è¨ˆç®—ãŒå¿…è¦ãªå‡¦ç†</li>
                    <li>å¤§é‡ã®ãƒ«ãƒ¼ãƒ—å‡¦ç†</li>
                    <li>ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒé‡è¦ãªå ´é¢</li>
                </ul>
            </div>
            
            <div class="optimization-tip">
                <strong>JavaScriptã§ååˆ†ãªå ´é¢:</strong>
                <ul>
                    <li>å˜ç´”ãªãƒ”ã‚¯ã‚»ãƒ«å˜ä½ã®å¤‰æ›ï¼ˆã‚»ãƒ”ã‚¢ã€ãƒã‚¬ï¼‰</li>
                    <li>ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚„é–‹ç™ºé€Ÿåº¦é‡è¦–</li>
                    <li>WebAssemblyã®ãƒ“ãƒ«ãƒ‰ç’°å¢ƒæ§‹ç¯‰ãŒå›°é›£</li>
                    <li>ãƒ‡ãƒãƒƒã‚°ã®ã—ã‚„ã™ã•ã‚’é‡è¦–</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>ğŸ”® å°†æ¥ã®æœ€é©åŒ–å¯èƒ½æ€§</h2>
            
            <h3>1. SIMDå‘½ä»¤ã®æ´»ç”¨</h3>
            <div class="code-block">
// å°†æ¥çš„ãªSIMDæœ€é©åŒ–ä¾‹
#[cfg(target_feature = "simd128")]
use std::arch::wasm32::*;

fn process_pixels_simd(data: &mut [u8]) {
    // 16ãƒã‚¤ãƒˆï¼ˆ4ãƒ”ã‚¯ã‚»ãƒ«ï¼‰ã‚’åŒæ™‚å‡¦ç†
    // ç†è«–ä¸Š4å€ã®æ€§èƒ½å‘ä¸ŠãŒæœŸå¾…ã§ãã‚‹
}
            </div>
            
            <h3>2. WebGPUã¨ã®é€£æº</h3>
            <div class="code-block">
// GPUä¸¦åˆ—å‡¦ç†ã¨ã®çµ„ã¿åˆã‚ã›
// WebAssembly: CPUé›†ç´„çš„ãªå‰å‡¦ç†
// WebGPU: å¤§è¦æ¨¡ä¸¦åˆ—å‡¦ç†
// çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§æ›´ãªã‚‹é«˜é€ŸåŒ–ãŒå¯èƒ½
            </div>
            
            <h3>3. WebAssembly GCï¼ˆã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</h3>
            <div class="highlight">
                <strong>å°†æ¥ã®æ”¹å–„ç‚¹:</strong> WebAssembly GCã«ã‚ˆã‚Šã€ã‚ˆã‚Šè¤‡é›‘ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®åŠ¹ç‡çš„ãªå‡¦ç†ãŒå¯èƒ½ã«ãªã‚Šã€JavaScriptã¨ã®é€£æºãŒã•ã‚‰ã«ã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚‹äºˆå®š
            </div>
        </section>

        <section>
            <h2>ğŸ“ ã¾ã¨ã‚</h2>
            
            <div class="highlight">
                <strong>æ€§èƒ½æ¯”è¼ƒã®çµè«–:</strong>
                <ul>
                    <li><strong>è¨ˆç®—é›†ç´„çš„å‡¦ç†</strong>: WebAssemblyãŒ1.4ã€œ2.5å€é«˜é€Ÿ</li>
                    <li><strong>å˜ç´”ãªå‡¦ç†</strong>: JavaScriptã‚‚ååˆ†é«˜é€Ÿï¼ˆåŒç­‰æ€§èƒ½ï¼‰</li>
                    <li><strong>ç¾ä»£ã®JavaScript</strong>: V8ã‚¨ãƒ³ã‚¸ãƒ³ã®æœ€é©åŒ–ã«ã‚ˆã‚Šäºˆæƒ³ä»¥ä¸Šã«é«˜é€Ÿ</li>
                    <li><strong>é–‹ç™ºåŠ¹ç‡</strong>: JavaScriptã®æ–¹ãŒãƒ‡ãƒãƒƒã‚°ã‚„é–‹ç™ºãŒå®¹æ˜“</li>
                </ul>
            </div>
            
            <p>ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€šã˜ã¦ã€WebAssemblyã¨JavaScriptãã‚Œãã‚Œã®ç‰¹æ€§ã‚’ç†è§£ã—ã€é©åˆ‡ãªæŠ€è¡“é¸æŠãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚</p>
        </section>

        <footer style="margin-top: 50px; text-align: center; color: #7f8c8d;">
            <p><a href="index.html" style="color: #3498db;">â† æŠ€è¡“è§£èª¬ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</a></p>
        </footer>
    </div>
</body>
</html>